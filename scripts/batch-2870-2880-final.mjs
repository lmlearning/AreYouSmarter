#!/usr/bin/env node
import { readFile, writeFile } from 'fs/promises';

const newExplanations = [
  {
    "questionId": "high_school_biology_46",
    "explanation": "**All new alleles are the result of nucleotide variability** (mutations).\n\n**Types of genetic variation:**\n\n**1. Nucleotide variability (DNA sequence changes):**\n- Point mutations (substitutions)\n- Insertions, deletions\n- Creates NEW alleles\n- **Ultimate source of all variation**\n\n**2. Genotypic variation:**\n- Different allele combinations\n- From existing alleles\n- Reshuffled by sex\n\n**3. Phenotypic variation:**\n- Observable traits\n- From genotype + environment\n\n**Option 3 is CORRECT:**\n\"All new alleles are the result of nucleotide variability\" ✓\n- Mutation creates new alleles\n- Nucleotide changes → new DNA sequences\n- Only way to create novelty\n\n**Why other options are WRONG:**\n\n**Option 0: All phenotypic variation from genotypic**\n- **FALSE**\n- Environment also affects phenotype\n- **Phenotype = Genotype + Environment**\n- Example: Height (genes + nutrition)\n- Tan (genotype allows, but sun exposure required)\n- Muscle mass (genes + exercise)\n\n**Option 1: All genetic variation produces phenotypic**\n- **FALSE**\n- Many mutations are **silent/synonymous**\n- Neutral mutations (no phenotypic effect)\n- Redundancy in genetic code\n- Intron mutations\n- Example: GCU → GCC both code alanine\n\n**Option 2: All nucleotide variability results in neutral**\n- **FALSE**\n- Some mutations are beneficial (~1%)\n- Some are deleterious (~29%)\n- Some are neutral (~70%)\n- Not ALL neutral\n\n**Mutation types by effect:**\n\n**Neutral (~70%):**\n- No fitness effect\n- Synonymous substitutions\n- Non-coding regions\n- Drift in population\n\n**Deleterious (~29%):**\n- Harmful\n- Reduced fitness\n- Removed by selection\n- Example: Sickle cell (when homozygous)\n\n**Beneficial (~1%):**\n- Advantageous\n- Increased fitness\n- Selected for\n- Example: Lactase persistence\n\n**How new alleles arise:**\n\n**Mutation:**\n- DNA replication error\n- Chemical damage\n- Radiation\n- Spontaneous changes\n- **Changes nucleotide sequence**\n- **Creates new allele**\n\n**Example:**\n- Original allele A₁: ...ATCGAT...\n- Mutation: C → T\n- New allele A₂: ...ATTGAT...\n- Now two alleles exist\n\n**Not from recombination:**\n- Recombination SHUFFLES existing alleles\n- Doesn't create new ones\n- Crossing over, independent assortment\n- New combinations, not new alleles\n\n**Phenotype = Genotype + Environment:**\n\n**Examples:**\n\n**Height:**\n- Genotype: Tall genes\n- Environment: Good nutrition → tall\n- Environment: Poor nutrition → shorter\n- Same genotype, different phenotypes\n\n**Himalayan rabbit:**\n- Genotype: Temperature-sensitive enzyme\n- Cold ears/paws → dark (enzyme active)\n- Warm body → white (enzyme inactive)\n- Genotype same, phenotype varies with temperature\n\n**PKU (Phenylketonuria):**\n- Genotype: Cannot break down phenylalanine\n- Environment: Normal diet → intellectual disability\n- Environment: Low-phen diet → normal development\n- Same genotype, environment changes outcome\n\n**Genotypic variation WITHOUT phenotypic:**\n\n**Synonymous mutations:**\n- Different codons, same amino acid\n- GCU, GCC, GCA, GCG all → Alanine\n- Genetic code redundancy (wobble)\n- Genotype differs, protein identical\n\n**Intron mutations:**\n- Mutations in non-coding regions\n- Spliced out before translation\n- No effect on protein\n\n**Non-functional DNA:**\n- Pseudogenes\n- Intergenic regions\n- Changes don't affect phenotype\n\n**Neutral vs. Nearly neutral theory:**\n\n**Neutral theory (Kimura):**\n- Most variation is selectively neutral\n- Drift, not selection\n- Molecular clock\n\n**But:**\n- Not ALL mutations are neutral\n- Some beneficial (adaptation)\n- Some deleterious (removed)\n\n**The only TRUE statement:**\n\nAll new alleles come from nucleotide changes (mutations):\n- Point mutations\n- Insertions/deletions\n- Duplications\n- Inversions\n- **DNA sequence must change**\n- No other mechanism creates new alleles\n\nOnly nucleotide variability (mutation) creates entirely new alleles in the gene pool.",
    "reasoning": "Option 0: Phenotype = genes + environment (not just genes). Option 1: Some genetic changes silent (not phenotypic). Option 2: Some mutations beneficial/deleterious (not all neutral). Option 3: New alleles ONLY from nucleotide changes (mutations) ✓. Answer: option 3 (new alleles from nucleotide variability).",
    "steps": [
      "New alleles need DNA sequence change",
      "Mutation = nucleotide variability",
      "Only source of new alleles",
      "Recombination shuffles (doesn't create)",
      "All new alleles from mutation",
      "Answer: option 3 ✓ (nucleotide variability)"
    ],
    "generatedAt": "2025-01-14T17:30:00.000Z",
    "correctedAnswer": 3
  },
  {
    "questionId": "high_school_biology_47",
    "explanation": "We can digest starch but not cellulose because **the bonds linking monomers differ in shape** (α vs β linkages).\n\n**Starch vs. Cellulose:**\n\n**BOTH are:**\n- Polymers of glucose\n- (C₆H₁₂O₆)ₙ\n- Same monomer, different structure\n\n**KEY DIFFERENCE: Bond type**\n\n**Starch:**\n- **α-1,4 glycosidic bonds**\n- Glucose in α configuration\n- Helical structure\n- Digestible by amylase\n\n**Cellulose:**\n- **β-1,4 glycosidic bonds**\n- Glucose in β configuration\n- Linear, straight chains\n- NOT digestible by humans\n\n**Option 0 is CORRECT:**\n\"The bonds linking monomers differ in shape\" ✓\n- α vs β bonds\n- Different 3D structure\n- Enzymes specific to bond type\n- Humans have α-amylase, not β-cellulase\n\n**Why we can't digest cellulose:**\n\n**Enzyme specificity:**\n- **Amylase**: Breaks α-1,4 bonds (starch)\n- **Cellulase**: Breaks β-1,4 bonds (cellulose)\n- Humans produce amylase\n- **Humans do NOT produce cellulase**\n- Lock-and-key: Wrong bond shape → no digestion\n\n**α vs β glucose:**\n\n**α-glucose:**\n- -OH on carbon 1 points DOWN\n- Forms starch\n- Easily broken by amylase\n\n**β-glucose:**\n- -OH on carbon 1 points UP\n- Forms cellulose\n- Requires cellulase\n\n**Why other options are WRONG:**\n\n**Option 1: Starch molecules smaller**\n- **FALSE**\n- Both are large polymers\n- Starch: Amylose (1000s glucose), amylopectin (millions)\n- Cellulose: Also 1000s-10,000s glucose units\n- Size similar, not the issue\n\n**Option 2: Starch intracellular, cellulose extracellular**\n- **IRRELEVANT**\n- Starch in plants: energy storage (intracellular)\n- Cellulose: Plant cell wall (extracellular)\n- BUT we digest AFTER eating (all in gut)\n- Location in plant doesn't matter for digestion\n\n**Option 3: Starch hydrated, cellulose not**\n- **FALSE**\n- Both can be hydrated\n- Digestion IS hydrolysis (water added)\n- Hydration doesn't explain digestibility\n\n**Animals that CAN digest cellulose:**\n\n**Ruminants (cows, deer):**\n- Bacteria in rumen\n- Bacteria produce cellulase\n- Break down cellulose → short-chain fatty acids\n- Absorbed by cow\n\n**Termites:**\n- Gut bacteria/protists\n- Produce cellulase\n- Digest wood (cellulose)\n\n**Rabbits:**\n- Cecum bacteria\n- Produce cellulase\n- Coprophagy (eat feces) to reabsorb nutrients\n\n**Humans:**\n- NO cellulase\n- Cellulose = **dietary fiber**\n- Passes through undigested\n- Benefits: Bulks stool, feeds gut bacteria\n\n**Starch digestion in humans:**\n\n**1. Mouth:**\n- Salivary amylase\n- Begins breaking α-1,4 bonds\n- Starch → maltose\n\n**2. Small intestine:**\n- Pancreatic amylase\n- Maltase, sucrase, lactase\n- → Glucose\n\n**3. Absorption:**\n- Glucose absorbed into bloodstream\n- Used for energy\n\n**Cellulose in humans:**\n\n**1. Mouth → stomach → small intestine:**\n- NO digestion\n- No cellulase enzyme\n- Passes through unchanged\n\n**2. Large intestine:**\n- Gut bacteria ferment SOME\n- Produce short-chain fatty acids\n- Minor energy (5-10%)\n- Mostly stays intact\n\n**3. Exit:**\n- Fiber in feces\n- Provides bulk\n\n**Evolution:**\n\n**Why no cellulase in humans?**\n- Omnivorous diet\n- Sufficient energy from other sources\n- Large brain, small gut (can't ferment like herbivores)\n- Lost cellulase gene (or never had it)\n\n**Herbivores need cellulase:**\n- Diet mainly plants (cellulose)\n- Symbiotic bacteria provide it\n- Long digestive tract\n- Can extract energy from cellulose\n\n**The chemistry:**\n\n**α-1,4 bond:**\n- Oxygen bridge between C1-C4\n- Both glucose units same orientation\n- Amylase active site fits\n\n**β-1,4 bond:**\n- Oxygen bridge between C1-C4\n- Glucose units alternately flipped\n- Different 3D shape\n- Amylase can't fit\n- Need cellulase\n\nThe different glycosidic bond geometry requires different enzymes; humans lack cellulase.",
    "reasoning": "Starch and cellulose both glucose polymers. Difference: bond type (α vs β). Starch: α-1,4 bonds, amylase digests. Cellulose: β-1,4 bonds, need cellulase (humans lack). Not size (both large). Not location (both in gut after eating). Not hydration (both can hydrate). Answer: option 0 (bond shape differs).",
    "steps": [
      "Both glucose polymers",
      "Starch: α-1,4 bonds",
      "Cellulose: β-1,4 bonds",
      "Humans have amylase (α bonds)",
      "Humans lack cellulase (β bonds)",
      "Answer: option 0 ✓ (bond shape)"
    ],
    "generatedAt": "2025-01-14T17:31:00.000Z",
    "correctedAnswer": 0
  },
  {
    "questionId": "high_school_biology_48",
    "explanation": "In humans, fertilization normally occurs in the **fallopian tube** (oviduct).\n\n**Female reproductive anatomy:**\n\n**Ovary:**\n- Produces eggs (oocytes)\n- Releases egg during ovulation\n- **NOT where fertilization occurs**\n\n**Fallopian tube (oviduct):**\n- Connects ovary to uterus\n- **SITE OF FERTILIZATION** ✓\n- Specifically: ampulla (wide part of tube)\n- Egg waits here after ovulation\n- Sperm swim up to meet egg\n\n**Uterus:**\n- Where embryo implants\n- **NOT where fertilization occurs**\n- Fertilized egg travels here (3-5 days)\n\n**Placenta:**\n- Develops AFTER implantation\n- Connects fetus to uterine wall\n- **NOT site of fertilization**\n\n**Option 1 is CORRECT: Fallopian tube** ✓\n\n**Fertilization process:**\n\n**Day 0 (Ovulation):**\n- Ovary releases egg\n- Fimbriae (finger-like projections) catch egg\n- Egg enters fallopian tube\n\n**Day 0-1 (Fertilization):**\n- Egg in ampulla of fallopian tube\n- Sperm swim through cervix, uterus, into tube\n- One sperm penetrates egg\n- **Fertilization occurs in FALLOPIAN TUBE**\n- Zygote forms\n\n**Day 1-5 (Cleavage):**\n- Zygote divides while traveling down tube\n- 2 cells → 4 → 8 → 16 → morula → blastocyst\n- Cilia in tube push toward uterus\n\n**Day 5-6 (Implantation):**\n- Blastocyst arrives in uterus\n- Implants in uterine wall (endometrium)\n- Pregnancy begins\n\n**Why other options are WRONG:**\n\n**Option 0: Ovary**\n- Site of egg production\n- Ovulation releases egg FROM ovary\n- Fertilization is AFTER ovulation\n- In tube, not ovary\n\n**Option 2: Uterus**\n- **COMMON MISCONCEPTION**\n- Uterus is where embryo develops\n- But fertilization BEFORE reaching uterus\n- Happens in tube first\n\n**Option 3: Placenta**\n- Doesn't exist at fertilization\n- Develops weeks later\n- After implantation\n- Impossible\n\n**Ectopic pregnancy:**\n\n**Definition:**\n- Implantation outside uterus\n- Usually in fallopian tube\n- Can also be ovary, abdomen\n\n**Cause:**\n- Fertilized egg doesn't travel to uterus\n- Implants in tube instead\n- **~2% of pregnancies**\n\n**Danger:**\n- Tube can't support growing embryo\n- Risk of rupture\n- Life-threatening\n- Medical emergency\n\n**This shows fertilization IS in tube** (that's why ectopic pregnancy possible there)\n\n**Timeline summary:**\n\n**Location by day:**\n- Day 0: **Ovary** (ovulation)\n- Day 0-1: **Fallopian tube** (FERTILIZATION) ✓\n- Day 1-5: **Fallopian tube** (travel + cleavage)\n- Day 5-6: **Uterus** (implantation)\n- Day 6+: **Uterus** (development)\n\n**Sperm journey:**\n\n**1. Vagina:**\n- Sperm deposited\n\n**2. Cervix:**\n- Swim through cervical mucus\n- (easiest during ovulation)\n\n**3. Uterus:**\n- Swim across uterine cavity\n\n**4. Fallopian tube:**\n- Swim up tube\n- **Meet egg in ampulla**\n- Fertilization\n\n**Takes 30 min - 6 hours** for sperm to reach tube\n\n**Egg journey:**\n\n**1. Ovary:**\n- Released at ovulation\n\n**2. Fallopian tube:**\n- Caught by fimbriae\n- Waits in ampulla\n- **Viable for ~24 hours**\n- If no sperm: degenerates\n- If sperm arrives: fertilization\n\n**3. Uterus (if fertilized):**\n- Travels as dividing embryo\n- 3-5 days\n- Implants\n\n**Anatomy details:**\n\n**Fallopian tube parts:**\n- **Fimbriae**: Finger-like, catch egg\n- **Infundibulum**: Funnel near ovary\n- **Ampulla**: Wide section - **FERTILIZATION SITE** ✓\n- **Isthmus**: Narrow section\n- **Intramural**: Passes through uterine wall\n\n**Why ampulla?**\n- Widest part\n- Where egg waits\n- Sperm accumulate here\n- Optimal conditions\n\nFertilization occurs in the ampulla region of the fallopian tube, typically within 24 hours of ovulation.",
    "reasoning": "Fertilization sequence: Ovary releases egg → egg enters fallopian tube → sperm meets egg IN TUBE → fertilized egg travels to uterus → implants in uterus. Fertilization in TUBE (specifically ampulla). Not ovary (before fertilization). Not uterus (after fertilization). Not placenta (doesn't exist yet). Answer: option 1 (fallopian tube).",
    "steps": [
      "Ovulation: egg released from ovary",
      "Egg enters fallopian tube",
      "Sperm swim up to tube",
      "Fertilization in tube (ampulla)",
      "Then travels to uterus",
      "Answer: option 1 ✓ (fallopian tube)"
    ],
    "generatedAt": "2025-01-14T17:32:00.000Z",
    "correctedAnswer": 1
  }
];

// Read existing explanations
const existing = JSON.parse(await readFile('server/data/ai-explanations.json', 'utf-8'));

// Add new ones
const updated = [...existing, ...newExplanations];

// Write back
await writeFile('server/data/ai-explanations.json', JSON.stringify(updated, null, 2), 'utf-8');

console.log(`Added ${newExplanations.length} new explanations. Total: ${updated.length}`);
console.log(`Progress: ${updated.length}/14042 = ${(updated.length / 14042 * 100).toFixed(2)}%`);
console.log(`\\nSession total: ${updated.length - 2825} new explanations added`);
